<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.koreait.nearby.repository.MemberRepository">
	<resultMap type="Member" id="MemberMap">
		<result column="M_NO" property="mNo" />
		<result column="ID" property="id" />
		<result column="PW" property="pw" />
		<result column="NAME" property="name" />
		<result column="EMAIL" property="email" />
		<result column="BIRTHDAY" property="birthday" />
		<result column="PHONE" property="phone" />
		<result column="GENDER" property="gender" />
		<result column="STATE" property="state" />
	</resultMap>

   <!-- 회원가입 -->
     <insert id="joinMember" parameterType="Member">
     	INSERT INTO MEMBER 
     	VALUES ( MEMBER_SEQ.NEXTVAL, #{id}, #{pw}, #{name}, #{email}, #{birthday}, #{phone}, #{gender}, 0)
     </insert>


   <!-- 아이디 중복 확인  -->
	<select id="idCheck" parameterType="String" resultType="Member">
		select id, pw, name
		 from member
		 where id=#{id} 
	</select>

     <!-- 이메일 중복 확인 + 아이디 찾기  -->
	<select id="selectByEmail" parameterType="String" resultType="Member">
		select id, pw, name
		 from member
		 where email=#{email} 
	</select>

   <!-- 로그인  -->	
		<select id="login" parameterType="Member" resultType="Member">
			SELECT M_NO, ID, PW, NAME, EMAIL, BIRTHDAY, PHONE, GENDER, STATE
			  FROM MEMBER 
		    WHERE ID = #{id} AND PW = #{pw} AND STATE = 0
		 </select>
	
	
	<!-- 비밀번호 수정  -->
	<update id="updatePw" parameterType="Member">
		UPDATE MEMBER
		   SET PW = #{pw}
		 WHERE EMAIL = #{email}
	</update>
	
	
	<!-- 내정보 수정  name, birthday ,gender, phone  -->
	<update id="updateMember" parameterType="Member">
		UPDATE MEMBER
		   SET NAME = #{name}
		      ,birthday = #{birthday}
		      , gender=#{gender}
		      , phone=#{phone}
		 WHERE m_NO = #{mNo}
	</update>
	
	<!-- 회원탈퇴 -->
	<update id="leaveMember" parameterType="Long">
		UPDATE MEMBER
		   SET STATE = -1
		 WHERE M_NO = #{mNo}
	</update>
	
	
	
</mapper>